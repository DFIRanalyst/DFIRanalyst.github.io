---
title: "Hunting GUP.exe Abuse in the Wild: A Notepad++ Case Study"
date: 2026-02-02 10:30:00 -0500
categories: [Microsoft Defender, Splunk]
tags: [Notepad++, GUP.exe, Threat Hunting, File Creation, Malware, XDR]
---


## Why This Matters

When trusted applications are abused for post-exploitation activity, catching that behavior depends on knowing what "normal" looks like. 

This isn't about Notepad++ being malicious. It’s about understanding how built-in or trusted binaries can be abused and an example of how to spot those patterns across an enterprise environment.


## Threat Hunt Hypothesis

> **If** a threat actor abused `gup.exe` as seen in this case,  
> **then** we should look for it creating or launching executables like `update.exe`, `AutoUpdate.exe`, or `AutoUpgrader.exe` especially in user TEMP directories.

The Threat hunt hypotheses works by identifying the where, how, and who of a particular threat. 


## Initial Detection Query

Start narrow by targeting TEMP folder behavior:
```spl
index=xdr "properties.ActionType"="FileCreated"
| spath
| search properties.InitiatingProcessFileName="*gup.exe*"
| search (properties.FileName="update.exe" OR properties.FileName="AutoUpdate.exe" OR properties.FileName="AutoUpgrader.exe")
| search properties.FolderPath="*\\Temp\\*"
| stats count AS EventCount BY properties.DeviceName properties.FolderPath properties.FileName
| sort properties.DeviceName - EventCount
```

This catches instances where gup.exe is observed creating files with indicator names in high risk directories, as mentioned in intel.


## Go Broader: Expanded Search

For wider coverage, pivot to any file creation tied to gup.exe, regardless of location:
```spl
index=xdr properties.InitiatingProcessFileName="gup.exe*" "properties.ActionType"=FileCreated 
| stats count as EventCount by properties.DeviceName properties.FolderPath properties.FileName
| sort properties.DeviceName - EventCount
```

This pulls a larger net so you’ll need to filter out common plugin installs, updates, or benign usage tied to Notepad++. That means checking filenames, folder paths, hashes and especially anything that isn’t digitally signed or shows up in odd directories.


## Triage Tips

Once you've got hits, here's how to vet them:

Command Line: What did the new file actually do? Check the command line of any process that executed the file.

Hash: Look up its hash in VirusTotal or your Intel platform.

Path: Was it created somewhere odd (e.g., a hidden folder, startup location)?

User Context: Was it tied to a regular user or a privileged account?

Persistence Indicators: Was it added to a scheduled task, startup folder, or registry autorun key?


## Why This Technique Works

This method flips the script: instead of chasing known malware hashes, you’re looking at behavior, basically, what process created what file, where, and when. This is especially powerful when threat actors blend in by reusing trusted binaries like gup.exe.


## Takeaways

Don't ignore file creation logs, especially from binaries signed by known vendors.

TEMP folder + known malware filenames = a deeper look.

Treat parent-child relationships seriously.


## References

[Rapid7](https://www.rapid7.com/blog/post/tr-chrysalis-backdoor-dive-into-lotus-blossoms-toolkit/)

[Notepad++ Security Clarification](https://notepad-plus-plus.org/news/clarification-security-incident/)
